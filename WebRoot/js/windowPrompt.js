
function $obj(id){return document.getElementById(id);};function $height(obj){return parseInt(obj.style.height)||obj.offsetHeight;};var __windowPrompt_page_scripts=document.getElementsByTagName("script");var __windowPrompt_jsPath=__windowPrompt_page_scripts[__windowPrompt_page_scripts.length-1].src.substring(0,__windowPrompt_page_scripts[__windowPrompt_page_scripts.length-1].src.lastIndexOf("/")+1);__windowPrompt_page_scripts=null;var __windowPrompt_skin;function windowPrompt(name){this._bgAlpha=0.1;this._bgAlphaColor="#000000";this._insName=name||"(new windowPrompt())";this._ok=0;this._icon=null;this._startDrag=false;this._width=280;this._height=150;this._okFunc=null;this._cancelFunc=null;this._okBtn="<input type='button' onclick='"+this._insName+".doOK()' id='okBtn' style='cursor:pointer' class='btnStyle' value=' OK ' />";this._cancelBtn="<input type='button'onclick='"+this._insName+".doCancel()' id='cancelBtn' style='cursor:pointer' class='btnStyle' value=' Cancel ' />";this.setBtnByType=["",this._okBtn,this._cancelBtn,this._okBtn+"&nbsp;&nbsp;"+this._cancelBtn];this._path=__windowPrompt_jsPath||"";this._promptSkin=this._path+(__windowPrompt_skin||"skin");this._rootEl=document.compatMode=="CSS1Compat"?document.documentElement:document.body;this._docWidth=0;this._docHeight=0;var browser=function(s){return navigator.userAgent.toLowerCase().indexOf(s)!=-1};this._isOpera=browser("opera");this._isIE=browser("msie")!=-1&&(document.all&&!this.isOpera);this._addSkin();};windowPrompt.prototype._addSkin=function(){if($obj("promptCss"))return;var __style=document.createElement('link');__style.href=this._promptSkin+"/style/windowPrompt.css";__style.id="promptCss";__style.rel="stylesheet";__style.type="text/css";document.getElementsByTagName('HEAD')[0].appendChild(__style);__style=null;};windowPrompt.prototype.setWidth=function(w){if(/\d/.test(w)&&w>=this._width){this._width=w;}};windowPrompt.prototype.setHeight=function(h){if(/\d/.test(h)&&h>=this._height){this._height=h;}};windowPrompt.prototype.setFunc=function(func,tp){if(tp==1){this._okFunc=func;};if(tp==2){this._cancelFunc=func;}};windowPrompt.prototype.setIco=function(icon){this._icon=icon;};windowPrompt.prototype.alert=function(message,title){this._init();this._createWin(title||"Warn",message,1);};windowPrompt.prototype.confirm=function(message,title){this._init();this._createWin(title||"Confirm",message,3);};windowPrompt.prototype.changeSkin=function(value){var tempPromptSkin=this._promptSkin.substring(0,this._promptSkin.lastIndexOf("/")+1)+value;var reg=new RegExp(this._promptSkin,"ig");try{$obj("promptWinContainer").innerHTML=$obj("promptWinContainer").innerHTML.replace(reg,tempPromptSkin)}catch(e){};$obj("promptCss").href=tempPromptSkin+"/style/windowPrompt.css";this._promptSkin=tempPromptSkin;};windowPrompt.prototype._init=function(){this._showMask();};windowPrompt.prototype._destory=function(){this._removeMask();$obj("promptWinContainer").style.display="none";};windowPrompt.prototype._setDrag=function(event){this._startDrag=true;this._startX=event.x||event.pageX;this._startY=event.y||event.pageY;this._containX=$obj("promptWinContainer").offsetLeft;this._containY=$obj("promptWinContainer").offsetTop;$obj("promptWinContainer").style.left=this._containX+"px";$obj("promptWinContainer").style.top=this._containY+"px";$obj("promptWinContainer").style.margin="0px";var insName=this._insName;var _self=this;this._addEvent("mousemove",function(){var event=window.event||arguments[0];if(_self._startDrag){try{$obj("promptWinContainer").style.left=(_self._containX+(event.x||event.pageX)-_self._startX)+"px";$obj("promptWinContainer").style.top=(_self._containY+(event.y||event.pageY)-_self._startY)+"px";}catch(e){}}});this._addEvent("mouseup",function(){eval(insName+"._startDrag=false")});};windowPrompt.prototype._createWin=function(title,content,btnType){title=typeof(title)=="string"?title:"";content=typeof(content)=="string"?content.replace(/\n/g,"<br>").replace(/<([^>]*)>/g,"&lt;$1&gt;"):"";outerStyle="position:absolute;top:50%;left:50%;margin-left:"+(-this._width/2+this._rootEl.scrollLeft)+"px;width:"+this._width+"px;margin-top:"+(-this._height/2+this._rootEl.scrollTop)+"px;height:"+this._height+"px;z-index:10001";if(!$obj("promptWinContainer")){var title_div="<div style=\"cursor:move;width:100%;overflow:hidden\" onmousedown='"+this._insName+"._setDrag(event)' id=\"titleContainer\"><div style=\"float:left\" id=\"titleText\">&nbsp;</div><div style=\"float:right\" id=\"titleCtrl\"><img src='"+this._promptSkin+"/images/close.gif' border='0' valign='absmiddle' style='cursor:pointer' onclick='"+this._insName+".doCancel()' /></div></div>";var content_div="<div style='width:100%;overflow:visible' id='promptContent'><table cellpadding=0 cellspacing=0 border=0 style='margin:0px;padding:0px' align=center width='100%' height='100%' id='promptContentTable'><tr><td id='winMiddleLeft' width='3'>&nbsp;</td><td id='winMiddleCenter' style='background:url("+this._promptSkin+"/images/"+this._icon+") no-repeat 20px 50%'>&nbsp;</td><td id='winMiddleRight' width='3'>&nbsp;</td></tr>";if(btnType){content_div+="<tr><td height='30' id='winBtnLineLeft'>&nbsp;</td><td align='center' id='winBtnLineCenter'>&nbsp;</td><td id='winBtnLineRight'>&nbsp;</td></tr>";};content_div+="<tr><td id='winBottomLeft' width='3'></td><td id='winBottomCenter'></td><td id='winBottomRight'></td></tr></table></div>";var outContainer=document.createElement("div");this._addCSS(outContainer,outerStyle);outContainer.id="promptWinContainer";outContainer.innerHTML=title_div+content_div;document.body.appendChild(outContainer);outContainer=null;$obj("promptContent").style.height=(this._height-$obj("titleContainer").offsetHeight)+"px";var contentHeight=$height($obj("promptContent"))-$height($obj("winBottomLeft"));if($obj("winBtnLineLeft")){contentHeight-=$height($obj("winBtnLineLeft"))};$obj("winMiddleCenter").style.height=contentHeight+"px";};$obj("titleText").innerHTML=title;$obj("winMiddleCenter").innerHTML=content;$obj("winBtnLineCenter").innerHTML=this.setBtnByType[btnType];$obj("winMiddleCenter").style.backgroundImage="url("+this._promptSkin+"/images/"+this._icon+")";this._addCSS($obj("promptWinContainer"),outerStyle);$obj("promptWinContainer").style.display="";if(navigator.userAgent.indexOf("MSIE 7.0")>-1){$obj("titleContainer").style.width=$obj("promptContent").style.width=$obj("promptContent").style.height="0px";var _w=$obj("promptContentTable").offsetWidth;_w=(_w>parseInt($obj("promptWinContainer").style.width)?(_w+"px"):$obj("promptWinContainer").style.width);var _tHeight=$obj("titleContainer").offsetHeight;var _h=$obj("promptContentTable").offsetHeight+_tHeight;_h=(_h>parseInt($obj("promptWinContainer").style.height)?(_h+"px"):$obj("promptWinContainer").style.height);$obj("promptWinContainer").style.width=$obj("titleContainer").style.width=$obj("promptContent").style.width=_w;$obj("promptWinContainer").style.height=_h;$obj("promptContent").style.height=parseInt(_h)-_tHeight+"px";}else{$obj("titleContainer").style.width=$obj("promptContent").style.width=$obj("promptContent").style.height="auto";$obj("titleContainer").style.width=$obj("promptContent").style.width=$obj("promptContentTable").offsetWidth+"px";$obj("promptContent").style.height=$obj("promptContentTable").offsetHeight+"px";};this.okTab=1;$obj("okBtn").focus();if(!this.hasAddKeyEvent){this._addEvent("keydown",this._listenKeydown);var s=this;function resizeMask(){if($obj("promptShield")&&$obj("promptShield").style.display!="none")s._showMask()};this._addEvent("resize",resizeMask,window);this._addEvent("scroll",resizeMask,window);this.hasAddKeyEvent=1;}};windowPrompt.prototype._showMask=function(){if(!$obj("promptShield")){var shieldStyle="position:absolute;top:0px;left:0px;width:0;height:0;background:"+this._bgAlphaColor+";text-align:center;z-index:10000;filter:alpha(opacity="+(this._bgAlpha*100)+");opacity:"+this._bgAlpha+";";try{document.body.appendChild(document.createElement("<div id='promptShield' style=\""+shieldStyle+"\"></div>"));document.body.appendChild(document.createElement("<iframe id='promptShieldIframe'></iframe>"));}catch(e){var promptShield=document.createElement("div");promptShield.id="promptShield";promptShield.setAttribute("style",shieldStyle);document.body.appendChild(promptShield);promptShield=null;}};$obj("promptShield").style.display="none";var rootEl=this._rootEl;this._docHeight=((rootEl.scrollTop==0)?rootEl.clientHeight:rootEl.scrollHeight)+"px";this._docWidth=((rootEl.scrollLeft==0)?rootEl.clientWidth:rootEl.scrollWidth)+"px";$obj("promptShield").style.width=this._docWidth;$obj("promptShield").style.height=this._docHeight;var psIframe=$obj("promptShieldIframe");if(psIframe){this._addCSS(psIframe,$obj("promptShield").style.cssText+";z-index:9999;filter:alpha(opacity=0);opacity:0");psIframe.style.display="";};$obj("promptShield").style.display="";rootEl=null;document.body.onselectstart=function(){return false};document.body.oncontextmenu=function(){return false};};windowPrompt.prototype._removeMask=function(){$obj("promptShield").style.display="none";if($obj("promptShieldIframe")){$obj("promptShieldIframe").style.display="none";};document.body.onselectstart=function(){return true};document.body.oncontextmenu=function(){return true};};windowPrompt.prototype.doOK=function(){this._ok=1;this._destory();if(this._okFunc){if(typeof this._okFunc=="function"){this._okFunc();}else{eval(this._okFunc+"()");}}};windowPrompt.prototype.doCancel=function(){this._ok=0;this._destory();if(this._cancelFunc){if(typeof this._cancelFunc=="function"){this._cancelFunc();}else{eval(this._cancelFunc+"()");}}};windowPrompt.prototype._addCSS=function(obj,css,append){if(!append){this._isOpera?obj.setAttribute("style",css):obj.style.cssText=css;}else{this._isOpera?obj.setAttribute("style",obj.getAttribute("style")+css):obj.style.cssText+=css;}};windowPrompt.prototype._addEvent=function(env,fn,obj){obj=obj||document;if(this._isIE){obj.attachEvent("on"+env,fn);}else{obj.addEventListener(env,fn,false);}};windowPrompt.prototype._listenKeydown=function(){if(!$obj("promptWinContainer")||$obj("promptWinContainer").style.display=="none")return true;var ev=window.event||arguments[0];if(ev.keyCode==9){if(this.okTab&&$obj("cancelBtn")){$obj("cancelBtn").focus();this.okTab=0;}else{$obj("okBtn").focus();this.okTab=1;}};if(ev.keyCode==37){$obj("okBtn").focus();this.okTab=1};if(ev.keyCode==39&&$obj("cancelBtn")){$obj("cancelBtn").focus();this.okTab=0};if(ev.keyCode==13)return true;try{ev.keyCode=0;ev.cancelBubble=true;ev.returnValue=false;}catch(e){try{ev.stopPropagation();ev.preventDefault();}catch(e){}}};var tempPrompt;function initPromptInfo(a){if(!document.body){setTimeout(function(){initPromptInfo(a)},1);return};tempPrompt=tempPrompt||new windowPrompt("tempPrompt");tempPrompt.setWidth(a[0]);tempPrompt.setHeight(a[1]);tempPrompt.setFunc(a[2],1);tempPrompt.setFunc(a[3],2);tempPrompt.setIco(a[4]);a[7]?tempPrompt.confirm(a[5],a[6]):tempPrompt.alert(a[5],a[6]);};function Alert(message,width,height,title,func1,func2){initPromptInfo([width,height,func1,func2,"info.gif",message,title||"Prompt"]);};function SucceedInfo(message,width,height,title,func1,func2){initPromptInfo([width,height,func1,func2,"right.gif",message,title||"Success"]);};function ErrorInfo(errorMessage,width,height,title,func1,func2){initPromptInfo([width,height,func1,func2,"err.gif",errorMessage,title||"Error"]);};function ConfirmInfo(message,width,height,title,func1,func2){initPromptInfo([width,height,func1,func2,"ask.gif",message,title||"Confirm",1]);}

